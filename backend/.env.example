# guilde_lite_tdd_sprint Environment Variables

# === Project ===
PROJECT_NAME=guilde_lite_tdd_sprint
DEBUG=true
ENVIRONMENT=local

# === Logfire ===
# Get your token at https://logfire.pydantic.dev
LOGFIRE_TOKEN=
# Optional: read token for logfire query validation
LOGFIRE_READ_TOKEN=
# Optional: override send mode (true|false|if-token-present)
LOGFIRE_SEND_TO_LOGFIRE=if-token-present
LOGFIRE_SERVICE_NAME=guilde_lite_tdd_sprint
LOGFIRE_ENVIRONMENT=development
LOGFIRE_TRACE_URL_TEMPLATE=

# === PostgreSQL ===
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=guilde_lite_tdd_sprint

# === JWT Auth ===
# Generate with: openssl rand -hex 32
SECRET_KEY=change-me-in-production-use-openssl-rand-hex-32
ACCESS_TOKEN_EXPIRE_MINUTES=10080
ALGORITHM=HS256

# === API Key Auth ===
API_KEY=change-me-in-production
API_KEY_HEADER=X-API-Key

# === OAuth2 (Google) ===
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_REDIRECT_URI=http://localhost:8000/api/v1/oauth/google/callback

# === Redis ===
REDIS_HOST=localhost
REDIS_PORT=6379
# REDIS_PASSWORD=
REDIS_DB=0

# === Celery ===
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# === Sentry ===
SENTRY_DSN=

# === Prometheus ===
# Optional: set ENABLE_METRICS=true to expose /metrics
PROMETHEUS_METRICS_PATH=/metrics
PROMETHEUS_INCLUDE_IN_SCHEMA=false

# === S3/MinIO Storage ===
S3_ENDPOINT=
S3_ACCESS_KEY=
S3_SECRET_KEY=
S3_BUCKET=guilde_lite_tdd_sprint
S3_REGION=us-east-1

# === AI Agent (pydantic_ai) ===
LLM_PROVIDER=openai
OPENAI_API_KEY=
OPENAI_MODEL=openai-responses:gpt-4o-mini
OPENAI_BASE_URL=
OPENAI_ORG=
ANTHROPIC_API_KEY=
ANTHROPIC_MODEL=anthropic:claude-opus-4-5-20251101
# Note: the anthropic: prefix is optional (it is stripped for SDK calls).
ANTHROPIC_BASE_URL=
OPENROUTER_API_KEY=
OPENROUTER_MODEL=
# Fallback model if provider-specific model is not set
AI_MODEL=gpt-4o-mini
AI_TEMPERATURE=0.7
# Judge model (OpenAI Responses required for dual-subagent flow)
JUDGE_MODEL=openai-responses:gpt-5.2-codex
# Dual-subagent + judge flow (OpenAI + Anthropic)
DUAL_SUBAGENT_ENABLED=true
AGENT_BROWSER_ENABLED=true
AGENT_BROWSER_TIMEOUT_SECONDS=60
HTTP_FETCH_ENABLED=true
HTTP_FETCH_TIMEOUT_SECONDS=15
HTTP_FETCH_MAX_CHARS=12000

# === Telemetry ===
# Optional local JSONL file for quick analysis
TELEMETRY_FILE=telemetry/agent_runs.jsonl

# === CORS ===
# JSON list of allowed origins (default: localhost:3000, localhost:8080)
# Note: "*" is blocked in production - specify explicit origins
CORS_ORIGINS=["http://localhost:3000","http://localhost:8080"]

# === Docker Production (Traefik) ===
# Domain for production deployment
DOMAIN=example.com

# Let's Encrypt email for SSL certificates
ACME_EMAIL=admin@example.com

# Traefik dashboard auth (generate with: htpasswd -nb admin password)
# TRAEFIK_DASHBOARD_AUTH=admin:$$apr1$$...
# Redis password for production
REDIS_PASSWORD=change-me-in-production
# Flower monitoring credentials
FLOWER_USER=admin
FLOWER_PASSWORD=change-me-in-production

# =============================================================================
# DIAGNOSTIC TOOLING CONFIGURATION
# Self-diagnostic features for development debugging and observability
# =============================================================================

# === dev3000 Debug Server ===
DEV3000_ENABLED=false
DEV3000_PORT=3001
DEV3000_MODE=development
DEV3000_LOG_LEVEL=debug
DEV3000_BACKEND_URL=http://localhost:8000
DEV3000_AGENT_URL=http://localhost:8001
DEV3000_FRONTEND_URL=http://localhost:3000

# === MCP Configuration ===
MCP_SERVER_NAME=guilde-diag
MCP_TRANSPORT=stdio
MCP_TOOLS_ENABLED=true
MCP_RESOURCES_ENABLED=true

# === Circuit Breaker Configuration ===
CIRCUIT_BREAKER_ENABLED=true
CIRCUIT_BREAKER_REDIS_URL=redis://localhost:6380/0
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
CIRCUIT_BREAKER_RECOVERY_TIMEOUT=30
CIRCUIT_BREAKER_HALF_OPEN_REQUESTS=3
CIRCUIT_BREAKER_SUCCESS_THRESHOLD=2

# Per-service circuit breaker overrides
CB_OPENAI_FAILURE_THRESHOLD=3
CB_OPENAI_RECOVERY_TIMEOUT=60
CB_ANTHROPIC_FAILURE_THRESHOLD=3
CB_ANTHROPIC_RECOVERY_TIMEOUT=60

# === Enhanced Observability (Logfire) ===
LOGFIRE_DIAGNOSTIC_SPANS=true
LOGFIRE_CONSOLE_ENABLED=true
LOGFIRE_CONSOLE_COLORS=true
LOGFIRE_CONSOLE_VERBOSE=false

# === Enhanced Observability (Sentry) ===
SENTRY_TRACES_SAMPLE_RATE=1.0
SENTRY_PROFILES_SAMPLE_RATE=0.1
SENTRY_DEBUG=false
SENTRY_ATTACH_STACKTRACE=true

# === Diagnostic API Configuration ===
DIAGNOSTIC_MODE=false
DIAGNOSTIC_VERBOSE=false
DIAGNOSTIC_AUTH_REQUIRED=false
DIAGNOSTIC_RATE_LIMIT=100
DIAGNOSTIC_WEBSOCKET_ENABLED=true

# === Health Check Configuration ===
HEALTH_CHECK_TIMEOUT=5
HEALTH_CHECK_INCLUDE_DETAILS=true
HEALTH_CHECK_EXTERNAL_SERVICES=true
HEALTH_DEEP_CHECK_ENABLED=true
HEALTH_DEEP_CHECK_INTERVAL=60

# === Performance Thresholds ===
HEALTH_WARN_DB_LATENCY_MS=100
HEALTH_WARN_REDIS_LATENCY_MS=50
HEALTH_WARN_API_LATENCY_MS=500
HEALTH_WARN_MEMORY_PERCENT=80

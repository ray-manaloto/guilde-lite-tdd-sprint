# Paired Subagent Review (business-analyst)

Provider: openai
Model: gpt-5.2-codex

---

- **Adopt Agents SDK primitives for orchestration (Agent/Handoff/Guardrail/Session)** and codify which workflows are *LLM‑led vs code‑led*; use **handoffs** for modular specialist subtasks and **guardrails + structured outputs** for predictable parsing. *Decision:* which steps must be deterministic (code‑led) vs exploratory (LLM‑led). *Risk:* uncontrolled tool loops or unparseable outputs without schema/guardrails. Sources: https://developers.openai.com/tracks/building-agents# , https://medium.com/@abdulkabirlive1/openai-agents-sdk-expert-level-guide-to-orchestration-44eeb67e1ec7  

- **Instrument Agents SDK runs (cost/latency/accuracy) from day one** and budget time for prompt/model tuning. *Decision:* define telemetry and acceptance criteria in spec. *Risk:* unpredictable performance in production without monitoring/optimization loop. Source: https://developers.openai.com/tracks/building-agents#  

- **Standardize LiteLLM routing to Anthropic with `model="anthropic/..."` or `.../anthropic` base URL**, and explicitly set **`max_tokens`** instead of relying on LiteLLM’s default (4096). *Decision:* default token budget per call. *Risk:* silent default can increase cost/latency. Sources: https://docs.litellm.ai/docs/pass_through/anthropic_completion , https://docs.litellm.ai/docs/providers/anthropic  

- **Leverage LiteLLM’s automatic parameter mapping/structured output conversion** (OpenAI‑style `response_format` → Anthropic `output_schema`, plus required `anthropic-beta` header) for Claude Sonnet/Opus; **document which models are structured‑output capable**. *Decision:* approved Anthropic model list for JSON‑schema outputs. *Risk:* incompatible models silently ignore structured outputs. Source: https://docs.litellm.ai/docs/providers/anthropic  

- **If Azure Claude is in scope, encode `azure/claude-…` routing + `api_base` rules** and whether to disable LiteLLM’s automatic `/v1/messages` suffix. *Decision:* allow Azure Foundry routing vs standard Anthropic. *Risk:* incorrect endpoint suffix breaks calls. Source: https://docs.litellm.ai/docs/providers/anthropic  

- **Gate integration tests with pytest markers (e.g., `@pytest.mark.integration`) registered in config**, and default CI to `-m "not integration"`; require explicit opt‑in to run integration tests. *Decision:* marker‑based gating vs separate folder strategy. *Risk:* unregistered markers cause warnings or accidental execution in CI. Sources: https://stackoverflow.com/questions/66315234/exclude-some-tests-by-default , https://docs.pytest.org/latest/example/markers.html  

- **Optionally segregate `tests/integration/` if team prefers structural separation**, and document naming conventions (snake_case files/functions; CapWords classes). *Decision:* marker vs folder or both. *Risk:* inconsistent naming can reduce pytest collection predictability. Sources: https://stackoverflow.com/questions/54898578/how-to-keep-unit-tests-and-integrations-tests-separate-in-pytest , https://stackoverflow.com/questions/20513596/pep8-naming-convention-on-test-classes
